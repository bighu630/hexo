---
title: solidity合约升级
author: ivhu
date: 2024-11-23 11:43:38
categories:
  - 区块链
  - 智能合约
tags:
  - 合约升级
  - solidity
description:
---

## 为什么要做合约升级

就以太坊理想图景而言，合约升级是违背最初的“代码即法律”的构思的.

但是在生产环境中，我们不可不免的需要对已有的代码进行细微的改动（甚至有时候会有较大的改改动）,
就连以太坊自身也需要不断的迭代和升级,所以合约升级的问题实际上是《合约升级管理办法》 的问题

**合约升级的需求**
一般有两种需求

- 合约bug修复

  对于一个稍微复杂的dapp系统而言，在合约代码中，几乎不可避免的会存在一些bug,多数bag在测试阶段会被测试人员找到，
  但是测试也不能保证能找到所有的bug,现实中的扫雷不像是“扫雷”游戏那样，所有的雷都是按照逻辑规则来分布，也没有明确的雷区边界。
  越是复杂的合约，越是难以保证不会存在bug（以太坊上的合约漏洞历历在目），如果能通过合约升级来避免漏洞被黑客利用，反倒能更好的保证用户的财产安全.

- 新增需求

  随着dapp的发展，用户规模逐渐加大，最开始设计的产品可能已经无法满足客户的需求，这个时候如果能合理的理由合约升级，可以避免重新再写一套系统的损失。

**合约升级的好处**

- 解决合约中潜藏的bug,对bug做必要的修复
- 允许在原有的dapp系统中新增需求
- 重新重视dapp合约的生命周期管理（在没有合约升级之前，dapp合约的生命周期是固定的，但是现在可以更灵活的控制dapp的生命周期）

**合约升级的弊端**

- 破坏了“代码及法律”
- 合约升级引来了新的合约漏洞（以太坊上已经有项目被黑）
- 降低dapp的去中心性
  (现在大部分的可升级合约都是依赖一个合约管理员来管理合约的升级)

## 合约升级的关键

### 代理模式
